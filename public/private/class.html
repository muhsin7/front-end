<!DOCTYPE html>
<html>
  <head>
    <!-- /////////////////////////////////////////////////////// -->
    <link rel="stylesheet" href="../css/icons.css">
    <link rel="stylesheet" href="../css/materialize.css">
    <link rel="stylesheet" href="../css/materialize.css">
    <link rel="stylesheet" href="../css/nord-colours.css">
    <link rel="stylesheet" href="../css/styles.css">
    <!-- /////////////////////////////////////////////////////// -->

  </head>
  <body>
    <div class="fixed-action-btn">
      <a class="btn-floating btn-large nord-red modal-trigger" href="#post">
        <i class="large material-icons">mode_edit</i>
      </a>
   </div>
   <div class="modal modal-fixed-footer form" id="post" action="/api/post/create" method="POST" test-only="true">
     <div class="modal-content">
       <center>
         <h4>Post to ${class}</h4>
       </center>
        <div>
          <label>Title</label>
          <input type="text" name="classID" value="${classID}" class="hidden">
          <div class="row">
            <div class="input-field col s12">
              <input type="text" name="title" value="" placeholder="Enter title">
            </div>
          </div>
          <label>Content</label>
          <div class="row">
            <div class="input-field col s12">
              <textarea id="icon_prefix2" class="materialize-textarea" placeholder="Enter Content of post"></textarea>
              <!-- <label for="icon_prefix2">Enter Post</label> -->
            </div>
          </div>

        <div class="row">

          <!-- <div class="file-field input-field">

            <a class="red-button btn">
              <i class="material-icons">attach_file</i>
              <span>Attach file</span>
              <input type="file" multiple>
            </a>
            <div class="file-path-wrapper">
              <input class="file-path validate" type="text" placeholder="Upload one or more files">
            </div>
          </div> -->
        </div>
        </div>

     </div>
     <div class="modal-footer">
       <center>
         <a href="#" class="btn-flat postbutton waves-effect"><div class="post2">Post</div></a>
       </center>
     </div>
   </div>

    <nav class="nord-darkblue" role="navigation">
      <ul id="profileDropdown" class="dropdown-content">
        <li><a href="/profile/" class="modal-trigger">Profile</a></li>
        <li><a href="/auth/logout" class="modal-trigger">Log out</a></li>
      </ul>
      <div class="nav-wrapper container">
        <a id="logo-container" href="/home/" class="brand-logo"><img src="../images/cisco.png" height="50px" width="auto" style="padding-top:5px;" /></a>
        <ul class="right hide-on-med-and-down">
          <li><a href="/home/">Home</a></li>
          <li><a href="/assignments/">Assignments</a></li>
          <li><a class="dropdown-trigger" href="#!" data-target="profileDropdown"><i class="material-icons">person arrow_drop_down</i></a></li>
        </ul>

        <ul id="nav-mobile" class="sidenav">
          <li><a href="/home/">Home</a></li>
          <li><a href="/assignments/">Assignments</a></li>
          <li><a href="/profile/" class="modal-trigger">Profile</a></li>
          <li><a href="/auth/logout" class="modal-trigger">Log out</a></li>
        </ul>
        <a href="#" data-target="nav-mobile" class="sidenav-trigger"><i class="material-icons">menu</i></a>
      </div>
    </nav>




    <div class="container class-header">
      <div class="row">
        <h3>${class}</h3>
        <h5>${teachers}</h5>
        <h6>Class code: <span class="grey-text">${classCode}</span></h6>
        <a href="#" data-target="class_page_menu" class="dropdown-trigger"><i class="right-align material-icons medium class_menu">more_horiz</i></a>
      </div>
    </div>

    <ul class="dropdown-content" id="class_page_menu">
      <li class="color_list_item">
            <ul class="color-picker">
              <div href="#" class="color nord-lightblue"></div>
              <div href="#" class="color nord-darkblue"></div>
              <div href="#" class="color nord-darkgrey"></div>
              <div href="#" class="color nord-red"></div>
              <div href="#" class="color nord-orange"></div>
              <div href="#" class="color nord-purple"></div>
              <div href="#" class="color nord-yellow"></div>
            </ul>
        </li>
          <li class="class_options modal-trigger" href="#leaveModal"><a id="leaveClass">Leave class</a></li>
          <teacher-container>
            <li class="warn class_options modal-trigger renameClass" href="#renameModal"><a id="renameClass"><i class="material-icons">edit</i>Rename</a></li>
            <li class="warn class_options modal-trigger deleteClass" href="#deleteModal"><a id="deleteClass"><i class="material-icons">delete</i>Delete class</a></li>
          </teacher-container>
    </ul>

    <div class="modal" id="renameModal">
      <div class="modal-content">
        <center>
          <h4>Rename ${class}</h4>
        </center>
        <div class="form">
          <div class="input_field">
            <input type="text" name="newGroupName" id="newGroupName"/>
            <label for="newGroupName">Enter new group name</label>
          </div>
          <br />
          <center>
            <div class="nord-red btn-large modal-close">Cancel</div>
            <button type="submit" name="button" class="btn-large nord-darkblue">Rename</button>
          </center>
        </div>
      </div>
    </div>

    <div class="modal" id="deleteModal">
      <div class="modal-content">
        <center>
          <h4>Are you sure you want to delete ${class}?</h4>
          <h6><i>All data and posts from the group will be lost forever</i></h6>
        </center>
        <br />
        <center>
          <div class="nord-red btn-large modal-close">Cancel</div>
          <div class="btn-large nord-darkblue">Delete</div>
        </center>
      </div>
    </div>

    <div class="modal" id="leaveModal">
      <div class="modal-content">
        <center>
          <h4>Are you sure you want to leave ${class}?</h4>
          <h6><i>You will not be able to access the data and posts in this group unless you rejoin the group.</i></h6>
        </center>
        <br />
        <center>
          <div class="nord-red btn-large modal-close">Cancel</div>
          <div class="btn-large nord-darkblue">Leave Group</div>
        </center>
      </div>
    </div>

    <div class="modal" id="kickModal">
      <div class="modal-content">
        <center>
          <h4>Are you sure you want to remove ${student_name} from ${class}?</h4>
          <h6><i>The student will not be able to access the data and posts in this group unless they rejoin the group.</i></h6>
        </center>
        <br />
        <center>
          <div class="nord-darkblue btn-large modal-close">Cancel</div>
          <div class="btn-large nord-red">Remove</div>
        </center>
      </div>
    </div>


    <div class="container">
        <div class="row col s12">
          <div class="col s2">
            <a onclick="activateTab('postsTab','main');"><div class="tab">Posts</div></a>
            <a onclick="activateTab('membersTab','main');"><div class="tab">Members</div></a>
            <a onclick="activateTab('assignmentsTab','main');"><div class="tab">Assignments</div></a>
          </div>
          <div class="tab-container" tab-container-id="main">
            <div class="tab-panel col s8 offset-s1" tab-id="membersTab">
              <h3>Members</h3>
              <hr />
                <ul class="collection" id="membersList">

                  <session-error>
                    <li class="collection-item member_item"><div><a href="/profile/" class="member_name">Member name</a><!--<a href="#kickModal" class="modal-trigger secondary-content"><i class="material-icons remove_student nord-red valign-wrapper">close</i></a>--></div></li>
                    <li class="collection-item member_item"><div><a href="/profile/" class="member_name">Member name</a><!--<a href="#kickModal" class="modal-trigger secondary-content"><i class="material-icons remove_student nord-red valign-wrapper">close</i></a>--></div></li>
                    <li class="collection-item member_item"><div><a href="/profile/" class="member_name">Member name</a><!--<a href="#kickModal" class="modal-trigger secondary-content"><i class="material-icons remove_student nord-red valign-wrapper">close</i></a>--></div></li>
                  </session-error>
                </ul>
            </div>
            <div class="tab-panel activeTab col offset-s1 s8" tab-id="postsTab">
              <!-- <div class="col offset-s1 s8"> -->
          <h2>Posts</h2>
          <hr />
          <!-- <br /> -->
          <a href="#post" class="modal-trigger"><div class="post-btn btn"><center><b class="valign-wrapper"><i class="material-icons small">mode_edit</i>CREATE A POST</b></center></div></a>
          <br />
          <br />
        <!-- </div> -->
        <div>
          <div class="" id="postContainer">
            <div class="post hoverable" id="samplePost">
              <div class="post-header">
                <img class="post-pfp" src="../images/default.jpg" />
              </div>
              <div class="poster">Kabir De Sarkar<a href="#" class="dropdown-trigger" data-target="post-dropdown"><i class="material-icons post-options">more_horiz</i></a></div>
              <a href="#" class="post-class">IBDP1 Chemistry</a>
              <span class="date-text">3:45PM, Wednesday, October 15th, 2019</span>
              <div class="more">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</div>
              <ul class="collection files">
                <li class="collection-item" class="file"><div><a href="#">file_name.mp3</a><a href="#" class="secondary-content"><i class="white material-icons nord-purple download_file tiny">file_download</i></a></div></li>
                <li class="collection-item" class="file"><div><a href="#">file_name.mp3</a><a href="#" class="secondary-content"><i class="white material-icons nord-purple download_file tiny">file_download</i></a></div></li>
                <li class="collection-item" class="file"><div><a href="#">file_name.mp3</a><a href="#" class="secondary-content"><i class="white material-icons nord-purple download_file tiny">file_download</i></a></div></li>
              </ul>              <hr />
              <h6><b>Comments</b></h6>
              <div class="form">
                <input name="comment" type="text" class="comment-input"/>
                <button name="comment-btn" type="submit" name="button" class="right-align btn nord-red">Comment</button>
                <br /><br />
              </div>
              <div class="comments">
                <div class="comment">
                  <div class="comment-marker nord-darkblue"></div>
                  <img class="comment-pfp" src="../images/default.jpg"/>
                  <div class="comment-poster">Kabir</div><span class="date-text">3:45PM, Wednesday, October 15th, 2019</span>
                  <div class="comment-text more">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</div>
                </div>
              </div>
              <div class="load-more-comments">
                <a href="/post/">[Load more comments...]</a>
              </div>
            </div>
          </div>
        </div>
            </div>
            <div class="tab-panel col s9 offset-s1" tab-id="assignmentsTab">
              <h3>Assignments</h3>
              <hr />
              <div>
                  <div class="row">
                    <h4>All</h4>
                    <hr />
                  </div>
                  <div class="row">

                    <div class="col s3 assignment-item">
                      <div class="assignment-content">
                        <div class="assignment-name">Math stuff</div>
                        <div class="assignment-subject">Math</div>
                        <div class="due">Due Wednesday<br>October 16, 2019</div>
                        <center><div class="submitted btn submit">Submitted</div></center>
                      </div>
                    </div>


                  <div class="col s3 assignment-item">
                    <div class="assignment-content">
                      <div class="assignment-name">Chemistry stuff</div>
                      <div class="assignment-subject">Chemistry</div>
                      <div class="due">Due Tomorrow<br>October 15, 2019</div>
                      <center><div class="not-submitted btn submit"><div id="submit">Not Submitted</div></div></center>
                    </div>
                  </div>

                </div>

                <br>
                <br>

                <div class="row">
                  <h4>Due Soon</h4>
                  <hr />
                </div>
                <div class="row">
                  <div class="col s3 assignment-item">
                    <div class="assignment-content">
                      <div class="assignment-name">Chemistry stuff</div>
                      <div class="assignment-subject">Chemistry</div>
                      <div class="due">Due Tomorrow<br>October 15, 2019</div>
                      <center><div class="not-submitted btn submit"><div id="submit">Not Submitted</div></div></center>
                    </div>
                  </div>
                </div>

                <br>
                <br>

                <div class="row">
                  <h4>Submitted</h4>
                  <hr />
                </div>
                <div class="row">
                  <div class="col s3 assignment-item">
                    <div class="assignment-content">
                      <div class="assignment-name">Math stuff</div>
                      <div class="assignment-subject">Math</div>
                      <div class="due">Due Wednesday<br>October 16, 2019</div>
                      <center><div class="submitted btn submit">Submitted</div></center>
                    </div>
                  </div>
                </div>



              </div>
            </div>
          </div>
        </div>
    </div>
    <!-- /////////////////////////////////////////////////////// -->
    <script type="text/javascript" src="../js/angular.min.js"></script>
    <script type="text/javascript" src="../js/jquery.js"></script>
    <script type="text/javascript" src="../js/materialize.js"></script>
    <script type="text/javascript" src="../js/materialize.min.js"></script>
    <script type="text/javascript" src="../js/initializing.js"></script>
    <script type="text/javascript" src="../js/script.js"></script>
    <script type="text/javascript" src="../js/events.js"></script>
    <!-- /////////////////////////////////////////////////////// -->
    <script>
      /*$('div.color').click(function(){
        var classColor = this.className;
        alert(classColor);
        }
      )*/
      $.initSession();
      $('#leaveClass').on("click",(event) => {
        $.ajax({
          url:"/api/class/leave",
          type:"POST",
          data:{classID:splitUrl().lastElem()},
          success:function(e){
            window.location.href = "/home"
          }, error:function(e){
            alert("Error occured in operation")
            console.log(e)
          }
        })
      })
      $('#deleteClass').on("click",(event) => {
        $.ajax({
          url:"/api/class/disband",
          type:"POST",
          data:{classID:splitUrl().lastElem()},
          success:function(response){
            window.location.href = "/home"
          }, error:function(error){
            alert("Error occured in operation");
            console.log(error)
          }
        })
      })
      function activateTab(tabId){
        let mainElem = $(`[tab-id=${tabId}]`);
        mainElem.parent().children(".activeTab").removeClass('activeTab');
        mainElem.addClass('activeTab')
      }
      $.ajax({
        url:"/api/post/list",
        type:"POST",
        data:{classID:splitUrl().lastElem()},
        success:function(response){
          // console.log(response)
          // let postContainer = $('#postContainer')
          // for(let post of response){
          //   let {classID,content,title,posterName,dateCreated} = post;
          //   dateCreated = new Date(dateCreated).getSemiSimpleTime();
          //
          //   let elem = $(`<div class="post">
          //     <h5>${title}</h5>
          //     <h7>${posterName}</h7><br>
          //     <span class="grey-text small-text">${dateCreated}</span>
          //     <h6>${content}</h6>
          //   </div>`)
          //   postContainer.append(elem)
          // }
          // if(response.length == 0){
          //   postContainer.append($(`<center><h6 class="grey-text">No posts to be loaded</h6></center>`))
          // }
        }, error:function(error){
          $('#samplePost').removeClass("hidden")
          console.error(error.responseText)
        }
      })
      $.ajax({
        url:"/api/class/"+$.splitUrl()[$.splitUrl().length-1]+"/list/members",
        success:function(data){
          // console.log(data)
          for(let person of data){
            $('#membersList').append(
              $(
                `<li class="collection-item member_item"><div><a href="/profile/" class="member_name">${person.username}</a><!--<a href="#kickModal" class="modal-trigger secondary-content"><i class="material-icons remove_student nord-red valign-wrapper">close</i></a>--></div></li>`
              )
            )
          }
        },error:function(err){
          console.log(err)
        }
      })
      // function show(){
      //   if this.hasClass("class_members"){
      //     this.css("visibility", "visible");
      //     $('.class_posts').css("visibility", "hidden");
      //     $('.class_assignments').css("visibility", "hidden");
      //   }
      //
      //   else if this.hasClass("class_posts"){
      //     this.css("visibility", "visible");
      //     $('.class_members').css("visibility", "hidden");
      //     $('.class_assignments').css("visibility", "hidden");
      //   }
      //
      //   else if this.hasClass("class_assignments"){
      //     this.css("visibility", "visible");
      //     $('.class_posts').css("visibility", "hidden");
      //     $('.class_members').css("visibility", "hidden");
      //   }
      // }

      // $(".renameModal").on("click", function(){
      //   var instance = M.Modal.getInstance("#renameModal");
      //   instance.open();
      // })
    </script>

  </body>
</html>
